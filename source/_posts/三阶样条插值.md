---
title: 三阶样条插值
date: 2020-01-20 15:40:18
tags: 插值
categories: 数学建模
---

#### 引入

​    当使用单一函数用于拟合数据时，有时不能达到很好的效果，此时我们可以考虑用分段函数来拟合。为预测未知数据点，我们可以使用**插值**的方法。

​	在连续数据点对间使用直线来拟合，称为**线性插值**；在连续的数据点对间使用不同的三阶多项式来预测，称为**三阶样条插值**。

#### 算法

考虑有三个数据点的情况，在区间 $x_1\leq x <x_2$ 和 $x_2\leq x<x_3$ 中，分别定义样条函数：
$$
S_1(x)=a_1+b_1x+c_1x^2+d_1x^3 \quad x\in [x_1,x_2)\\
S_2(x)=a_2+b_2x+c_2x^2+d_2x^3 \quad x\in [x_2,x_3]
$$
它们的导数：
$$
S'_1(x)=b_1+2c_1x+3d_1x^2 \quad x\in[x_1,x_2)\\
S''_1(x)=2c_1+6d_1x \quad x\in [x_1,x_2)\\
S'_2(x)=b_2+2c_2x+3d_2x^2 \quad x\in[x_2,x_3]\\
S''_2(x)=2c_2+6d_2x \quad x\in [x_2,x_3]
$$
让每一样条的端点通过数据点，有：
$$
y_1=S_1(x_1)=a_1+b_1x_1+c_1x_1^2+d_1x_1^3\\
y_2=S_1(x_2)=a_1+b_1x_2+c_1x_2^2+d_1x_2^3\\
y_2=S_2(x_2)=a_2+b_2x_2+c_2x_2^2+d_2x_2^3\\
y_3=S_2(x_3)=a_2+b_2x_3+c_2x_3^2+d_2x_3^3
$$


​	三阶样条插值不仅要让每一内部数据点的斜率匹配，还要让曲率匹配，即在每一内部数据点邻接的一阶导数和二阶导数都要匹配，因此，有方程：
$$
S'_1(x_2)=S'_2(x_2)\\
S''_1(x_2)=S''_2(x_2)
$$


​	对于外侧的数据点可有两种条件：

1. 外侧端点的一阶导数没有变化，即二阶导数为0，这样产生的样条称为**自然样条**：
   $$
   S''_1(x_1)=S''_2(x_3)=0
   $$

2. 外侧端点的一阶导数的值已知，称为**强制样条**：
   $$
   S'_1(x_1)=f'(x_1)\\
   S'_2(x_3)=f'(x_3)
   $$
   一般除非外侧端点的一阶导数明确已知，通常使用自然样条。